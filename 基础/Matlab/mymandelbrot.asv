clear
clc

grid = 1024;
width = 0.1;
s = width*(-1:1/grid:1);
center =-0.7700 - 0.1300*1i;
[u,v] = meshgrid(s+real(center),s+imag(center));

z0 = u + 1i*v;

z1 = gpuArray(z0);
depth = ones
tic
kzgpu = arrayfun(@mandelbrot,z1);
toc


% tic
% kzcpu = arrayfun(@mandelbrot,z0);
% toc

image(kzgpu)
axis image
colormap(flipud(jet(512)))


function kz = mandelbrot(z0, depth)
    z = z0;
    kz = 0;
    while (z*conj(z) <= 4) && (kz <= depth)
        kz = kz + 1;
        z = z*z + z0;
    end
end